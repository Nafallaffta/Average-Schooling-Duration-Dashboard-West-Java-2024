# Merged data
jabar_merged <- Indo %>%
left_join(data, by = c("WADMKK" = "Kabupaten/Kota"))
# --------------------------- ANALISIS DESKRIPTIF ------------------------------
# Statistik deskriptif untuk semua variabel numerik
head(data)
summary(data)
# Sebarannya
hist(data$`Rata-Rata.Lama.Sekolah`,
col = "skyblue", border = "white",
main = "Distribusi Rata-rata Lama Sekolah di Jawa Barat",
xlab = "Rata-rata Lama Sekolah (tahun)")
# ------------------------- PLOT JARINGAN TETANGGA -----------------------------
# Ubah ke format Spatial untuk fungsi spdep
jabar_sp <- as_Spatial(jabar_merged)
row.names(jabar_sp) <- jabar_sp$WADMKK
# Buat daftar ketetanggaan (queen contiguity)
W <- poly2nb(jabar_sp, row.names = row.names(jabar_sp), queen = TRUE)
WL <- nb2listw(W, style = "W", zero.policy = TRUE)
summary(W)
# Buat Plot
CoordJ <- coordinates(jabar_sp)
plot(jabar_sp, axes = TRUE, col = "gray90",
main = "Jaringan Ketetanggaan Kabupaten/Kota di Jawa Barat")
# -----------Morans'I-----------
Global_Moran <- moran.test(
jabar_merged$`Rata.Rata.Lama.Sekolah`,
WL,
zero.policy = TRUE
)
Global_Moran
# -----------Geary's C-----------
Global_Geary <- geary.test(
jabar_merged$`Rata.Rata.Lama.Sekolah`,
WL,
zero.policy = TRUE
)
Global_Geary
# -----------Getis-Ord General G-----------
row.names(jabar_sp) <- jabar_sp$WADMKK
jabar_merged <- jabar_merged[match(row.names(jabar_sp), jabar_merged$WADMKK), ]
lwB <- nb2listw(W, style = "B", zero.policy = TRUE)  # biner (0/1)
lwW <- nb2listw(W, style = "W", zero.policy = TRUE)  # row-standardized (weight row sum = 1)
Wb_mat <- listw2mat(lwB)   # matriks bobot biner
x_raw <- jabar_merged$`Rata.Rata.Lama.Sekolah`
na_idx <- is.na(x_raw)
if(any(na_idx)) {
message(sum(na_idx), " observasi memiliki NA pada variabel; NA akan diperlakukan sebagai 0 untuk perhitungan G raw.")
}
x_for_calc <- x_raw
x_for_calc[is.na(x_for_calc)] <- 0
sum_x <- sum(x_for_calc)
num_G <- as.numeric(Wb_mat %*% x_for_calc)
den_G <- (sum_x - x_for_calc)
G_raw <- num_G / den_G
Wb_star <- Wb_mat
diag(Wb_star) <- 1
num_Gs <- as.numeric(Wb_star %*% x_for_calc)
den_Gs <- sum_x
G_star_raw <- num_Gs / den_Gs
Gz <- as.numeric(spdep::localG(x_for_calc, listw = lwW, zero.policy = TRUE))
jabar_G <- dplyr::mutate(
jabar_merged,
G_raw = G_raw,
G_star_raw = G_star_raw,
z_Gistar = Gz,
hotcold = dplyr::case_when(
z_Gistar >=  1.96 ~ "Hot spot (p<=0.05)",
z_Gistar <= -1.96 ~ "Cold spot (p<=0.05)",
TRUE              ~ "Not significant"
)
)
# Cek ringkasan
summary(dplyr::select(jabar_G, G_raw, G_star_raw, z_Gistar))
table(jabar_G$hotcold, useNA = "ifany")
# ---------------------------
# 4) Peta: G* raw (proporsi) dan peta hot/cold (z-score)
# ---------------------------
library(ggplot2)
library(viridis)
# peta G*_raw (kontinu)
p1 <- ggplot(jabar_G) +
geom_sf(aes(fill = G_star_raw), color = "white", size = 0.2) +
scale_fill_viridis_c(option = "C", na.value = "grey90") +
labs(title = "Raw Getisâ€“Ord G* (proporsi massa tetangga)",
subtitle = "Variabel: Rata-Rata Lama Sekolah",
fill = "G*_raw") +
theme_minimal()
# peta hot/cold (kategori)
# atur urutan factor agar legend rapi
jabar_G$hotcold <- factor(jabar_G$hotcold,
levels = c("Hot spot (p<=0.05)", "Cold spot (p<=0.05)", "Not significant"))
p2 <- ggplot(jabar_G) +
geom_sf(aes(fill = hotcold), color = "white", size = 0.2) +
scale_fill_manual(values = c("Hot spot (p<=0.05)" = "#b2182b",
"Cold spot (p<=0.05)" = "#2166ac",
"Not significant" = "grey85"),
na.value = "grey90") +
labs(title = "Getisâ€“Ord Gi* â€” Hot/Cold Spots (z-score)",
subtitle = "z(G*_i) berdasarkan localG (alpha = 0.05)",
fill = NULL) +
theme_minimal()
# Tampilkan peta
print(p1)
print(p2)
# -----------LISA---------------
# Local Moranâ€™s I
Local_Moran <- localmoran(jabar_merged$`Rata-Rata.Lama.Sekolah`, WL, zero.policy = TRUE)
# Visualisasi LISA
ggplot(jabar_merged) +
geom_sf(aes(fill = cluster)) +
scale_fill_manual(values = c(
"High-High" = "red",
"Low-Low" = "blue",
"High-Low" = "orange",
"Low-High" = "green",
"Non-signifikan" = "grey80"
)) +
labs(
title = "Peta Klaster Autokorelasi Lokal (LISA)",
subtitle = "Variabel: Rata-rata Lama Sekolah di Jawa Barat",
fill = "Tipe Klaster"
) +
theme_minimal()
# -----------LISA---------------
# Local Moranâ€™s I
Local_Moran <- localmoran(jabar_merged$`Rata.Rata.Lama.Sekolah`, WL, zero.policy = TRUE)
# Tambahkan hasil LISA ke data spasial
colnames(Local_Moran) <- c("Ii", "E.Ii", "Var.Ii", "Z.Ii", "P.value")
jabar_merged$Ii <- Local_Moran[, "Ii"]
jabar_merged$Z.Ii <- Local_Moran[, "Z.Ii"]
jabar_merged$P.value <- Local_Moran[, "P.value"]
# Klasifikasi Klaster LISA
mean_var <- mean(jabar_merged$`Rata.Rata.Lama.Sekolah`, na.rm = TRUE)
mean_lag <- lag.listw(WL, jabar_merged$`Rata.Rata.Lama.Sekolah`)
jabar_merged$cluster <- NA
jabar_merged$cluster[jabar_merged$`Rata.Rata.Lama.Sekolah` >= mean_var & mean_lag >= mean(mean_lag)] <- "High-High"
jabar_merged$cluster[jabar_merged$`Rata.Rata.Lama.Sekolah` <= mean_var & mean_lag <= mean(mean_lag)] <- "Low-Low"
jabar_merged$cluster[jabar_merged$`Rata.Rata.Lama.Sekolah` >= mean_var & mean_lag <= mean(mean_lag)] <- "High-Low"
jabar_merged$cluster[jabar_merged$`Rata.Rata.Lama.Sekolah` <= mean_var & mean_lag >= mean(mean_lag)] <- "Low-High"
jabar_merged$cluster[jabar_merged$P.value > 0.05] <- "Non-signifikan"
# Visualisasi LISA
ggplot(jabar_merged) +
geom_sf(aes(fill = cluster)) +
scale_fill_manual(values = c(
"High-High" = "red",
"Low-Low" = "blue",
"High-Low" = "orange",
"Low-High" = "green",
"Non-signifikan" = "grey80"
)) +
labs(
title = "Peta Klaster Autokorelasi Lokal (LISA)",
subtitle = "Variabel: Rata-rata Lama Sekolah di Jawa Barat",
fill = "Tipe Klaster"
) +
theme_minimal()
library(spdep)
library(ggplot2)
library(dplyr)
# Daftar variabel X
x_vars <- c(
"PAD", "DAU.Pendidikan", "PDRB", "Tingkat.Kemiskinan",
"Rasio.Guru.dan.Murid.SD", "Rasio.Guru.dan.Murid.SMP",
"Rasio.Guru.dan.Murid.SMA", "APM.SD", "APM.SMP", "APM.SMA", "APM.PT"
)
# Buat list kosong untuk menyimpan hasil global
hasil_moran <- list()
hasil_geary <- list()
hasil_getis <- list()
# Loop semua variabel
for (v in x_vars) {
cat("\n=====================================\n")
cat("ðŸ”¹ Variabel:", v, "\n")
cat("=====================================\n")
# Skip kalau variabel tidak ada
if (!v %in% names(jabar_merged)) {
cat("âŒ Variabel", v, "tidak ditemukan di data.\n")
next
}
# -------------------- Global Tests --------------------
moran_res <- moran.test(jabar_merged[[v]], WL, zero.policy = TRUE)
geary_res <- geary.test(jabar_merged[[v]], WL, zero.policy = TRUE)
getis_res <- globalG.test(jabar_merged[[v]], WL, zero.policy = TRUE)
hasil_moran[[v]] <- moran_res
hasil_geary[[v]] <- geary_res
hasil_getis[[v]] <- getis_res
cat("Moran's I :", round(moran_res$estimate[1], 4),
"| p =", round(moran_res$p.value, 4), "\n")
cat("Geary's C :", round(geary_res$estimate[1], 4),
"| p =", round(geary_res$p.value, 4), "\n")
cat("Getis-Ord G :", round(getis_res$estimate[1], 4),
"| p =", round(getis_res$p.value, 4), "\n")
# -------------------- LISA (Local Moranâ€™s I) --------------------
lisa <- localmoran(jabar_merged[[v]], WL, zero.policy = TRUE)
colnames(lisa) <- c("Ii", "E.Ii", "Var.Ii", "Z.Ii", "P.value")
# Salin data agar tidak menimpa variabel lain
temp_map <- jabar_merged
temp_map$Ii <- lisa[, "Ii"]
temp_map$P.value <- lisa[, "P.value"]
temp_map$lag_var <- lag.listw(WL, jabar_merged[[v]])
mean_var <- mean(jabar_merged[[v]], na.rm = TRUE)
mean_lag <- mean(temp_map$lag_var, na.rm = TRUE)
temp_map$cluster <- NA
temp_map$cluster[jabar_merged[[v]] >= mean_var & temp_map$lag_var >= mean_lag] <- "High-High"
temp_map$cluster[jabar_merged[[v]] <= mean_var & temp_map$lag_var <= mean_lag] <- "Low-Low"
temp_map$cluster[jabar_merged[[v]] >= mean_var & temp_map$lag_var <= mean_lag] <- "High-Low"
temp_map$cluster[jabar_merged[[v]] <= mean_var & temp_map$lag_var >= mean_lag] <- "Low-High"
temp_map$cluster[temp_map$P.value > 0.05] <- "Non-signifikan"
# -------------------- Plot LISA --------------------
print(
ggplot(temp_map) +
geom_sf(aes(fill = cluster)) +
scale_fill_manual(values = c(
"High-High" = "red",
"Low-Low" = "blue",
"High-Low" = "orange",
"Low-High" = "green",
"Non-signifikan" = "grey80"
)) +
labs(
title = paste("Peta Klaster LISA â€”", v),
subtitle = "Autokorelasi Lokal (Local Moranâ€™s I)",
fill = "Tipe Klaster"
) +
theme_minimal()
)
}
summary_autokorelasi <- data.frame(
Variabel = x_vars,
Moran_I = sapply(hasil_moran, \(x) x$estimate[1]),
Moran_p = sapply(hasil_moran, \(x) x$p.value),
Geary_C = sapply(hasil_geary, \(x) x$estimate[1]),
Geary_p = sapply(hasil_geary, \(x) x$p.value),
Getis_G = sapply(hasil_getis, \(x) x$estimate[1]),
Getis_p = sapply(hasil_getis, \(x) x$p.value)
)
print(summary_autokorelasi)
# --------------------------- ANALISIS DESKRIPTIF ------------------------------
# Statistik deskriptif untuk semua variabel numerik
head(data)
summary(data)
# --------------------------- ANALISIS DESKRIPTIF ------------------------------
# Statistik deskriptif untuk semua variabel numerik
data
shiny::runApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
rsconnect::deployApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
runApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
rsconnect::deployApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
#install.packages('rsconnect')
rsconnect::setAccountInfo(name='nafallaffta',
token='64FFAECC66CEB72D8E18C22973DE522A',
secret='VLBVEKQtZu0p6sovYOr9BXUnODwUCzEG7AGWyfzB')
rsconnect::deployApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
#install.packages('rsconnect')
rsconnect::setAccountInfo(name='nafallaffta',
token='64FFAECC66CEB72D8E18C22973DE522A',
secret='VLBVEKQtZu0p6sovYOr9BXUnODwUCzEG7AGWyfzB')
rsconnect::deployApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
shiny::runApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
library(rsconnect)
rsconnect::deployApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah/app.R")
rsconnect::deployApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah/app.R")
rsconnect::deployApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah/app.R')
rsconnect::deployApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
# ----------------------------
# Load libraries
# ----------------------------
library(shiny)
library(shinydashboard)
library(shinyWidgets)
library(dplyr)
library(plotly)
library(leaflet)
library(DT)
library(spdep)
library(spatialreg)
library(sf)
library(sp)
library(openxlsx)
library(tidyr)
library(lmtest)
library(car)
library(ggplot2)
library(GGally)
library(DiagrammeR)
# --- Load data shapefile dan Excel ---
Indo <- st_read("shapefile/RBI_50K_2023_Jawa Barat.shp")
data <- read.xlsx("data/DATA SPASIAL.xlsx")
# --- Merge shapefile dan data ---
jabar_merged <- Indo %>%
left_join(data, by = c("WADMKK" = "Kabupaten/Kota"))
runApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
library(openxlsx)
data <- read.xlsx("E:/SMT 5/Epidemologi/DATA EPIDEMIOLOGI.xlsx")
head(data)
cat("=" , rep("=", 60), "\n", sep="")
cat("UKURAN FREKUENSI PENYAKIT DBD\n")
cat("=" , rep("=", 60), "\n\n", sep="")
# 1.1 PREVALENSI (per 100,000 penduduk)
data$Prevalensi <- (data$Jumlah_DBD / data$Jumlah_Penduduk) * 100000
head(data)
# Load library
library(openxlsx)
# Baca data dari Excel
# GANTI PATH INI SESUAI LOKASI FILE ANDA
data <- read.xlsx("E:/SMT 5/Epidemologi/DATA EPIDEMIOLOGI.xlsx")
# Lihat struktur data
cat("Struktur Data:\n")
print(head(data))
cat("\n")
# Rename kolom untuk memudahkan penggunaan
names(data) <- c("Wilayah", "Jumlah_DBD", "Sanitasi_Layak", "Kepadatan_Penduduk",
"Lama_Sekolah", "Jumlah_Puskesmas", "Jumlah_RS", "Air_Minum_Layak",
"Tingkat_Kemiskinan", "Jumlah_Penduduk")
cat("=" , rep("=", 60), "\n", sep="")
cat("UKURAN FREKUENSI PENYAKIT DBD\n")
cat("=" , rep("=", 60), "\n\n", sep="")
# 1.1 PREVALENSI (per 100,000 penduduk)
data$Prevalensi <- (data$Jumlah_DBD / data$Jumlah_Penduduk) * 100000
cat("1. PREVALENSI DBD (per 100,000 penduduk)\n")
cat("-" , rep("-", 60), "\n", sep="")
prev_summary <- data.frame(
Wilayah = data$Wilayah,
Kasus_DBD = data$Jumlah_DBD,
Populasi = data$Jumlah_Penduduk,
Prevalensi = round(data$Prevalensi, 2)
)
print(prev_summary)
cat("\nRingkasan Statistik Prevalensi:\n")
cat(sprintf("- Prevalensi Minimum  : %.2f per 100,000 penduduk (%s)\n",
min(data$Prevalensi), data$Wilayah[which.min(data$Prevalensi)]))
cat(sprintf("- Prevalensi Maksimum : %.2f per 100,000 penduduk (%s)\n",
max(data$Prevalensi), data$Wilayah[which.max(data$Prevalensi)]))
cat(sprintf("- Prevalensi Rata-rata: %.2f per 100,000 penduduk\n", mean(data$Prevalensi)))
cat(sprintf("- Prevalensi Median   : %.2f per 100,000 penduduk\n\n", median(data$Prevalensi)))
# 1.2 INSIDENSI (Asumsi: data adalah kasus baru dalam 1 tahun)
# Insidensi = (Jumlah kasus baru dalam periode) / (Jumlah populasi berisiko) x konstanta
data$Insidensi <- (data$Jumlah_DBD / data$Jumlah_Penduduk) * 100000
cat("2. INSIDENSI DBD (per 100,000 penduduk per tahun)\n")
cat("-" , rep("-", 60), "\n", sep="")
cat("Catatan: Asumsi data adalah kasus baru dalam periode 1 tahun\n\n")
inc_summary <- data.frame(
Wilayah = data$Wilayah,
Kasus_Baru = data$Jumlah_DBD,
Populasi_Berisiko = data$Jumlah_Penduduk,
Insidensi = round(data$Insidensi, 2)
)
print(inc_summary)
cat("\nRingkasan Statistik Insidensi:\n")
cat(sprintf("- Insidensi Minimum  : %.2f per 100,000 penduduk/tahun (%s)\n",
min(data$Insidensi), data$Wilayah[which.min(data$Insidensi)]))
cat(sprintf("- Insidensi Maksimum : %.2f per 100,000 penduduk/tahun (%s)\n",
max(data$Insidensi), data$Wilayah[which.max(data$Insidensi)]))
cat(sprintf("- Insidensi Rata-rata: %.2f per 100,000 penduduk/tahun\n", mean(data$Insidensi)))
cat(sprintf("- Insidensi Median   : %.2f per 100,000 penduduk/tahun\n\n", median(data$Insidensi)))
# 1.3 ATTACK RATE
# Attack rate untuk keseluruhan Jawa Barat
total_kasus <- sum(data$Jumlah_DBD)
total_populasi <- sum(data$Jumlah_Penduduk)
attack_rate <- (total_kasus / total_populasi) * 100
cat("3. ATTACK RATE DBD di Jawa Barat\n")
cat("-" , rep("-", 60), "\n", sep="")
cat(sprintf("Total Kasus DBD      : %d kasus\n", total_kasus))
cat(sprintf("Total Populasi       : %d jiwa\n", total_populasi))
cat(sprintf("Attack Rate          : %.4f%%\n", attack_rate))
cat(sprintf("                     : %.2f per 1,000 penduduk\n\n", attack_rate * 10))
cat("\n")
cat("=" , rep("=", 60), "\n", sep="")
cat("UKURAN ASOSIASI (FAKTOR RISIKO DBD)\n")
cat("=" , rep("=", 60), "\n\n", sep="")
# 2.1 Kategorisasi variabel eksposur
median_sanitasi <- median(data$Sanitasi_Layak)
median_kepadatan <- median(data$Kepadatan_Penduduk)
median_kemiskinan <- median(data$Tingkat_Kemiskinan)
data$Sanitasi_Kategori <- ifelse(data$Sanitasi_Layak >= median_sanitasi, "Tinggi", "Rendah")
data$Kepadatan_Kategori <- ifelse(data$Kepadatan_Penduduk >= median_kepadatan, "Tinggi", "Rendah")
data$Kemiskinan_Kategori <- ifelse(data$Tingkat_Kemiskinan >= median_kemiskinan, "Tinggi", "Rendah")
# Kategorisasi outcome (Insidensi DBD tinggi/rendah)
median_insidensi <- median(data$Insidensi)
data$DBD_Kategori <- ifelse(data$Insidensi >= median_insidensi, "Tinggi", "Rendah")
cat("1. RISK RATIO: Sanitasi Layak terhadap Insidensi DBD\n")
cat("-" , rep("-", 60), "\n", sep="")
# Tabel 2x2
exposed_disease <- sum(data$Sanitasi_Kategori == "Rendah" & data$DBD_Kategori == "Tinggi")
exposed_no_disease <- sum(data$Sanitasi_Kategori == "Rendah" & data$DBD_Kategori == "Rendah")
unexposed_disease <- sum(data$Sanitasi_Kategori == "Tinggi" & data$DBD_Kategori == "Tinggi")
unexposed_no_disease <- sum(data$Sanitasi_Kategori == "Tinggi" & data$DBD_Kategori == "Rendah")
cat("Tabel 2x2:\n")
table_2x2 <- matrix(c(exposed_disease, exposed_no_disease,
unexposed_disease, unexposed_no_disease),
nrow = 2, byrow = TRUE,
dimnames = list(c("Sanitasi Rendah (Exposed)", "Sanitasi Tinggi (Unexposed)"),
c("DBD Tinggi", "DBD Rendah")))
print(table_2x2)
# Hitung Risk
risk_exposed <- exposed_disease / (exposed_disease + exposed_no_disease)
risk_unexposed <- unexposed_disease / (unexposed_disease + unexposed_no_disease)
risk_ratio <- risk_exposed / risk_unexposed
cat(sprintf("\nRisk pada Exposed (Sanitasi Rendah)    : %.4f\n", risk_exposed))
cat(sprintf("Risk pada Unexposed (Sanitasi Tinggi)  : %.4f\n", risk_unexposed))
cat(sprintf("Risk Ratio (RR)                         : %.4f\n", risk_ratio))
if(risk_ratio > 1) {
cat(sprintf("\nInterpretasi: Wilayah dengan sanitasi rendah memiliki risiko %.2f kali\n", risk_ratio))
cat("lebih tinggi untuk mengalami insidensi DBD tinggi dibanding wilayah\n")
cat("dengan sanitasi tinggi.\n\n")
} else if(risk_ratio < 1) {
cat(sprintf("\nInterpretasi: Wilayah dengan sanitasi rendah memiliki risiko %.2f kali\n", 1/risk_ratio))
cat("lebih rendah untuk mengalami insidensi DBD tinggi dibanding wilayah\n")
cat("dengan sanitasi tinggi (faktor protektif).\n\n")
} else {
cat("\nInterpretasi: Tidak ada asosiasi antara sanitasi dengan insidensi DBD.\n\n")
}
cat("2. ODDS RATIO: Kepadatan Penduduk terhadap Insidensi DBD\n")
cat("-" , rep("-", 60), "\n", sep="")
# Tabel 2x2
a <- sum(data$Kepadatan_Kategori == "Tinggi" & data$DBD_Kategori == "Tinggi")
b <- sum(data$Kepadatan_Kategori == "Tinggi" & data$DBD_Kategori == "Rendah")
c <- sum(data$Kepadatan_Kategori == "Rendah" & data$DBD_Kategori == "Tinggi")
d <- sum(data$Kepadatan_Kategori == "Rendah" & data$DBD_Kategori == "Rendah")
cat("Tabel 2x2:\n")
table_kepadatan <- matrix(c(a, b, c, d),
nrow = 2, byrow = TRUE,
dimnames = list(c("Kepadatan Tinggi (Exposed)", "Kepadatan Rendah (Unexposed)"),
c("DBD Tinggi", "DBD Rendah")))
print(table_kepadatan)
# Hitung Odds Ratio
odds_exposed <- a / b
odds_unexposed <- c / d
odds_ratio <- (a * d) / (b * c)
cat(sprintf("\nOdds pada Exposed (Kepadatan Tinggi)   : %.4f\n", odds_exposed))
cat(sprintf("Odds pada Unexposed (Kepadatan Rendah) : %.4f\n", odds_unexposed))
cat(sprintf("Odds Ratio (OR)                         : %.4f\n", odds_ratio))
if(odds_ratio > 1) {
cat(sprintf("\nInterpretasi: Wilayah dengan kepadatan penduduk tinggi memiliki odds %.2f kali\n", odds_ratio))
cat("lebih tinggi untuk mengalami insidensi DBD tinggi dibanding wilayah\n")
cat("dengan kepadatan penduduk rendah.\n\n")
} else if(odds_ratio < 1) {
cat(sprintf("\nInterpretasi: Wilayah dengan kepadatan penduduk tinggi memiliki odds %.2f kali\n", 1/odds_ratio))
cat("lebih rendah untuk mengalami insidensi DBD tinggi dibanding wilayah\n")
cat("dengan kepadatan penduduk rendah (faktor protektif).\n\n")
} else {
cat("\nInterpretasi: Tidak ada asosiasi antara kepadatan penduduk dengan insidensi DBD.\n\n")
}
cat("3. ATTRIBUTABLE RISK: Tingkat Kemiskinan terhadap Insidensi DBD\n")
cat("-" , rep("-", 60), "\n", sep="")
# Tabel 2x2
e1 <- sum(data$Kemiskinan_Kategori == "Tinggi" & data$DBD_Kategori == "Tinggi")
e2 <- sum(data$Kemiskinan_Kategori == "Tinggi" & data$DBD_Kategori == "Rendah")
u1 <- sum(data$Kemiskinan_Kategori == "Rendah" & data$DBD_Kategori == "Tinggi")
u2 <- sum(data$Kemiskinan_Kategori == "Rendah" & data$DBD_Kategori == "Rendah")
cat("Tabel 2x2:\n")
table_kemiskinan <- matrix(c(e1, e2, u1, u2),
nrow = 2, byrow = TRUE,
dimnames = list(c("Kemiskinan Tinggi (Exposed)", "Kemiskinan Rendah (Unexposed)"),
c("DBD Tinggi", "DBD Rendah")))
print(table_kemiskinan)
# Hitung Attributable Risk
incidence_exposed <- e1 / (e1 + e2)
incidence_unexposed <- u1 / (u1 + u2)
attributable_risk <- incidence_exposed - incidence_unexposed
attributable_risk_percent <- (attributable_risk / incidence_exposed) * 100
cat(sprintf("\nInsidensi pada Exposed (Kemiskinan Tinggi)   : %.4f\n", incidence_exposed))
cat(sprintf("Insidensi pada Unexposed (Kemiskinan Rendah) : %.4f\n", incidence_unexposed))
cat(sprintf("Attributable Risk (AR)                        : %.4f\n", attributable_risk))
cat(sprintf("Attributable Risk Percent (AR%%)               : %.2f%%\n", attributable_risk_percent))
if(attributable_risk > 0) {
cat(sprintf("\nInterpretasi: Dari total risiko DBD tinggi pada wilayah dengan kemiskinan\n"))
cat(sprintf("tinggi, sebanyak %.2f%% dapat diatribusikan kepada faktor kemiskinan.\n", attributable_risk_percent))
cat(sprintf("Jika faktor kemiskinan dieliminasi, maka akan terjadi penurunan risiko\n"))
cat(sprintf("DBD tinggi sebesar %.4f pada wilayah dengan kemiskinan tinggi.\n\n", attributable_risk))
} else {
cat("\nInterpretasi: Kemiskinan tinggi tidak meningkatkan risiko DBD tinggi.\n\n")
}
cat("=" , rep("=", 60), "\n", sep="")
cat("RINGKASAN HASIL ANALISIS\n")
cat("=" , rep("=", 60), "\n\n", sep="")
cat("UKURAN FREKUENSI:\n")
cat(sprintf("1. Prevalensi rata-rata : %.2f per 100,000 penduduk\n", mean(data$Prevalensi)))
cat(sprintf("2. Insidensi rata-rata  : %.2f per 100,000 penduduk/tahun\n", mean(data$Insidensi)))
cat(sprintf("3. Attack Rate Jabar    : %.4f%% atau %.2f per 1,000 penduduk\n\n", attack_rate, attack_rate * 10))
cat("UKURAN ASOSIASI:\n")
cat(sprintf("1. Risk Ratio (Sanitasi)        : %.4f\n", risk_ratio))
cat(sprintf("2. Odds Ratio (Kepadatan)       : %.4f\n", odds_ratio))
cat(sprintf("3. Attributable Risk (Kemiskinan): %.4f (%.2f%%)\n\n", attributable_risk, attributable_risk_percent))
cat("=" , rep("=", 60), "\n", sep="")
cat("ANALISIS SELESAI\n")
cat("=" , rep("=", 60), "\n", sep="")
cat("=" , rep("=", 60), "\n", sep="")
cat("RINGKASAN HASIL ANALISIS\n")
cat("=" , rep("=", 60), "\n\n", sep="")
cat("UKURAN FREKUENSI:\n")
cat(sprintf("1. Prevalensi rata-rata : %.2f per 100,000 penduduk\n", mean(data$Prevalensi)))
cat(sprintf("2. Insidensi rata-rata  : %.2f per 100,000 penduduk/tahun\n", mean(data$Insidensi)))
cat(sprintf("3. Attack Rate Jabar    : %.4f%% atau %.2f per 1,000 penduduk\n\n", attack_rate, attack_rate * 10))
cat("UKURAN ASOSIASI:\n")
cat(sprintf("1. Risk Ratio (Sanitasi)        : %.4f\n", risk_ratio))
cat(sprintf("2. Odds Ratio (Kepadatan)       : %.4f\n", odds_ratio))
cat(sprintf("3. Attributable Risk (Kemiskinan): %.4f (%.2f%%)\n\n", attributable_risk, attributable_risk_percent))
cat("=" , rep("=", 60), "\n", sep="")
cat("ANALISIS SELESAI\n")
cat("=" , rep("=", 60), "\n", sep="")
cat("=" , rep("=", 60), "\n", sep="")
cat("RINGKASAN HASIL ANALISIS\n")
cat("=" , rep("=", 60), "\n\n", sep="")
cat("UKURAN FREKUENSI:\n")
cat(sprintf("1. Prevalensi rata-rata : %.2f per 100,000 penduduk\n", mean(data$Prevalensi)))
cat(sprintf("2. Insidensi rata-rata  : %.2f per 100,000 penduduk/tahun\n", mean(data$Insidensi)))
cat(sprintf("3. Attack Rate Jabar    : %.4f%% atau %.2f per 1,000 penduduk\n\n", attack_rate, attack_rate * 10))
cat("UKURAN ASOSIASI:\n")
shiny::runApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
runApp('E:/SMT 5/Analisis Data Spasial/Dashboard_Rata_rata_Lama_Sekolah')
